<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Handling bundles in activities and fragments - Jestřáblog</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="http://blog.petrnohejl.cz/favicon.ico" rel="icon">

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="Jestřáblog" />
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Handling bundles in activities and fragments"/>
            <meta property="og:url" content="http://blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments"/>
            <meta property="og:description" content="Bundle is a useful data holder, which maps String values to various Parcelable types. So basically it is a heterogenous key/value map. Bundles are used in Intents, Activities and Fragments for transporting data. I would like to describe how I work with Bundles on Android and show you some ..."/>
            <meta property="article:published_time" content="2014-03-30" />
            <meta property="article:section" content="Android" />

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.petrnohejl.cz/theme/css/bootstrap.cosmo.min.css" type="text/css"/>
    <link href="http://blog.petrnohejl.cz/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.petrnohejl.cz/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.petrnohejl.cz/theme/css/style.css" type="text/css"/>
        <link href="http://blog.petrnohejl.cz/static/custom.css" rel="stylesheet">


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.petrnohejl.cz/" class="navbar-brand">
Jestřáblog            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/categories.html">Categories</a></li>
                    <li><a href="/feed.xml">Feed</a></li>
                    <li><a href="http://petrnohejl.cz/">About me</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.petrnohejl.cz/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-lg-12">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments"
                       rel="bookmark"
                       title="Permalink to Handling bundles in activities and fragments">
                        Handling bundles in activities and fragments
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2014-03-30T00:00:00"> 30.3.2014</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><a href="http://developer.android.com/reference/android/os/Bundle.html">Bundle</a> is a useful data holder, which maps String values to various <a href="http://developer.android.com/reference/android/os/Parcelable.html">Parcelable</a> types. So basically it is a heterogenous key/value map. Bundles are used in <a href="http://developer.android.com/reference/android/content/Intent.html">Intents</a>, <a href="http://developer.android.com/reference/android/app/Activity.html">Activities</a> and <a href="http://developer.android.com/reference/android/app/Fragment.html">Fragments</a> for transporting data. I would like to describe how I work with Bundles on Android and show you some good tips.</p>
<h2 id="activity">Activity</h2>
<p>When you are creating a new instance of Activity via Intent, you can pass some extra data to the Activity. Data are stored in Bundle and can be retrieved by calling <code>getIntent().getExtras()</code>. It's a good practise to implement static method <code>newIntent()</code> which returns a new Intent that can be used to start the Activity. This way you have compile time checking for the arguments passed to the Activity. This pattern is suitable for Service and Broadcast as well.</p>
<p>Bundle is also used if the Activity is being re-initialized (e.g. because of configuration changes) for keeping the current state of the instance. You can supply some data in <code>onSaveInstanceState(Bundle)</code> and retrieve them back in <code>onCreate(Bundle)</code> method or <code>onRestoreInstanceState(Bundle)</code>. Main difference between these methods is that <code>onRestoreInstanceState(Bundle)</code> is called after <code>onStart()</code>. Sometimes it's convenient to restore data here after all of the initialization has been done. Another purpose could be allowing subclasses to decide whether to use your default implementation.</p>
<p>See example code below. Note that <code>EXTRA_PRODUCT_ID</code> constant is public. That's because we could need it in a Fragment encapsulated in this Activity.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleActivity</span> <span class="kd">extends</span> <span class="n">Activity</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXTRA_PRODUCT_ID</span> <span class="o">=</span> <span class="s">&quot;product_id&quot;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">EXTRA_PRODUCT_TITLE</span> <span class="o">=</span> <span class="s">&quot;product_title&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SAVED_PAGER_POSITION</span> <span class="o">=</span> <span class="s">&quot;pager_position&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">Intent</span> <span class="nf">newIntent</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">String</span> <span class="n">productId</span><span class="o">,</span> <span class="n">String</span> <span class="n">productTitle</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">ExampleActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">// extras</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">EXTRA_PRODUCT_ID</span><span class="o">,</span> <span class="n">productId</span><span class="o">);</span>
        <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">EXTRA_PRODUCT_TITLE</span><span class="o">,</span> <span class="n">productTitle</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">intent</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_example</span><span class="o">);</span>

        <span class="c1">// restore saved state</span>
        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleSavedInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// handle intent extras</span>
        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleExtras</span><span class="o">(</span><span class="n">extras</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// save current instance state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>

        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRestoreInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// restore saved state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onRestoreInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="c1">// TODO</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleSavedInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleExtras</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">extras</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<h2 id="fragment">Fragment</h2>
<p>When you are creating a new instance of Fragment, you can pass arguments through <code>setArguments(Bundle)</code> method. Data can be retrieved with <code>getArguments()</code> method. It would be a mistake to supply initialization data through an overloaded constructor. Fragment instance can be re-created (e.g. because of configuration changes) so you would lose data, because constructor with extra parameters is not called when re-initializing Fragment. Only empty constructor is called. Best way to solve this problem is implementing static creator method <code>newInstance()</code> which returns a new instance of Fragment and sets the arguments via <code>setArguments(Bundle)</code>.</p>
<p>Fragment state can be saved using <code>onSaveInstanceState(Bundle)</code> method. It is similar to the Activity. Data can be restored in <code>onCreate(Bundle)</code>, <code>onCreateView(LayoutInflater, ViewGroup, Bundle)</code>, <code>onActivityCreated(Bundle)</code> or <code>onViewStateRestored(Bundle)</code> methods.</p>
<p>Fragment has also access to the Intent extras which were passed during creating the Activity instance. You can get this extra data by calling <code>getActivity().getIntent().getExtras()</code>.</p>
<p>See example code below.</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExampleFragment</span> <span class="kd">extends</span> <span class="n">Fragment</span>
<span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ARGUMENT_PRODUCT_ID</span> <span class="o">=</span> <span class="s">&quot;product_id&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SAVED_LIST_POSITION</span> <span class="o">=</span> <span class="s">&quot;list_position&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ExampleFragment</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">String</span> <span class="n">productId</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="n">ExampleFragment</span> <span class="n">fragment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ExampleFragment</span><span class="o">();</span>

        <span class="c1">// arguments</span>
        <span class="n">Bundle</span> <span class="n">arguments</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bundle</span><span class="o">();</span>
        <span class="n">arguments</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">ARGUMENT_PRODUCT_ID</span><span class="o">,</span> <span class="n">productId</span><span class="o">);</span>
        <span class="n">fragment</span><span class="o">.</span><span class="na">setArguments</span><span class="o">(</span><span class="n">arguments</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">fragment</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">ExampleFragment</span><span class="o">()</span> <span class="o">{}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> 
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="c1">// handle fragment arguments</span>
        <span class="n">Bundle</span> <span class="n">arguments</span> <span class="o">=</span> <span class="n">getArguments</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">arguments</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleArguments</span><span class="o">(</span><span class="n">arguments</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// restore saved state</span>
        <span class="k">if</span><span class="o">(</span><span class="n">savedInstanceState</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleSavedInstanceState</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="c1">// handle intent extras</span>
        <span class="n">Bundle</span> <span class="n">extras</span> <span class="o">=</span> <span class="n">getActivity</span><span class="o">().</span><span class="na">getIntent</span><span class="o">().</span><span class="na">getExtras</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span><span class="n">extras</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="n">handleExtras</span><span class="o">(</span><span class="n">extras</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSaveInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">outState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// save current instance state</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onSaveInstanceState</span><span class="o">(</span><span class="n">outState</span><span class="o">);</span>

        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleArguments</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">arguments</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleSavedInstanceState</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleExtras</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">extras</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="c1">// TODO</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>You can find example code also on my GitHub in <a href="https://github.com/petrnohejl/Android-Templates-And-Utilities/tree/master/Src-Bundle">Android Templates and Utilities</a> repo. This blogpost was inspired by <a href="https://plus.google.com/u/0/+AndroidDevelopers/posts/bCD7Zvd945d">Nick Butcher's post</a> on Google Plus. Gotta some questions or ideas about Bundles? Follow me on <a href="https://twitter.com/petrnohejl">Twitter</a> or <a href="https://plus.google.com/113883771155661250237">Google Plus</a>.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-530d2ad72de762c4"></script>
    <!-- AddThis Button END -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'petrnohejl'; // required: replace example with your forum shortname
            var disqus_identifier = 'handling-bundles-in-activities-and-fragments';
            var disqus_url = 'http://blog.petrnohejl.cz/handling-bundles-in-activities-and-fragments';
            var disqus_config = function () {
                this.language = "cs";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Petr Nohejl
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>              <p><small>  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.petrnohejl.cz/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.petrnohejl.cz/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'petrnohejl'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-17930136-2']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>